# RBAC in Kubernetes

RBAC -> Role Based Access Control

RBAC ka full form hai: **Role-Based Access Control**.

Iska kaam hai:
- Define karna ki kon (user, group, service account),
- kis resource par (pods, deployments, services, secrets, etc.),
- kya action (verbs: get, list, create, update, delete, watch),
- perform kar sakta hai ya nahi.

RBAC kubernetes ka security mechanism hota hai jo user, group ya service account ko kubernetes ke resources jaise pods, deployment, services, etc par permission provide karta hai. Permission ka matlab hai kya user, group ya service account kubernetes ke resources ko access kar sakta hai ya nhi.

<br>

### RBAC Kubernetes main kab use hota hai.

Kubernetes main jab user ya service account, kubernetes ke kisi bhi resource ko access karte hain to Api Server ko request send karte hain, Api Server ke paas request aane ke baad Api Server 3 task perform karta hai, Jaise:
- Authentication.
- Authorization.
- Validation.

Ye jo Authorization part hota hai, Yha pe RBAC ka part aata hai. Is Authorization task main Api Server RBAC ke through jo request Api Server par aayi hai uski permission check karta hai.

<br>

### RBAC ki zaroorat kyon padi?

Kubernetes ek multi-user system hai. Matlab cluster me ek hi time par multiple log (admins, developers, testers, CI/CD pipelines, monitoring tools) kaam kar rahe hote hain.

Agar hum sochen ki har kisi ko cluster-admin access de diya jaye to:
- Developer galti se ```kubectl delete pod --all -n production``` chala de → ```production crash```.
- Intern sirf pod dekhna chahata tha, par uske paas delete karne ka bhi access hai → ```risk```.
- Jenkins pipeline ko sirf apne namespace me deploy karna hai, par uske paas secrets dekhne ka bhi access aa gaya → ```security issue```.
- Company me compliance requirements hoti hain (ISO, SOC2, HIPAA) jo kehti hain ki ```“least privilege principle”``` follow karo → har user ko sirf utna access do jitna zaroori hai.

Isliye Kubernetes ne ek authorization mechanism banaya jisme tum define kar sako:
- Kaun (Subject: User, Group, ServiceAccount).
- Kis resource pe (pods, deployments, nodes, secrets, namespaces, PVs).
- Kaunsa action kar sakta hai (get, list, watch, create, update, delete, patch, exec)

Aur isi ka naam hai RBAC (Role-Based Access Control).

<br>

### Authorization ke Liye RBAC kyu aaya?

Pehle Kubernetes mein access control ke liye basic ABAC (Attribute-Based Access Control) hota tha jisme ek JSON policy file hoti thi jisme likha hota tha ki kaun kya kar sakta hai matlab kisko kya permission hai.

Problem:
- Har baar JSON file edit karni padti thi.
- Dynamic changes possible nahi the.
- Large clusters mein bahut complex ho jata tha.

Isliye Kubernetes ne introduce kiya: **RBAC (Role-Based Access Control)**.

<br>

### RBAC ka Concept

RBAC ka concept simple hai:
- Instead of directly binding permissions to users,groups or service accounts, tum permissions ko roles mein define karte ho. Fir users ya groups ko roles assign karte ho.
- Pehle tum ek role create karoge.
- Fir us role ko user, groups ya service account se bind karne ke liye ek role binding create karoge.
- RoleBinding se role main jo defined permissions hongi vo user, group ya service account ko attach ho jayengi.

Matlab ek 4 step ka system hai:
- **User / ServiceAccount** (koi entity jo cluster use karna chahti hai).\
- **Role** ya **ClusterRole** (ek permission set jo allow karta hai ki kya actions perform kar sakte ho).
- **RoleBinding** ya **ClusterRoleBinding** (ek mapping jo user ko ek role ke sath jodta hai).
- **Kubernetes API Server** (ye har request pe check karega ki user ke paas wo permission hai ya nahi).

<br>

### Components in RBAC

RBAC main 4 components hote hain:

**Role**:
- Role ek permission set hota hai jo sirf particular namespace main permission provide karta hai.
- Iska matlab ki role user, service account ko sirf ek namesapce main hi permission provide karega. Agar sabhi namespace main permission deni hai to ClusterRole create karna padta hai.

Example: Ek role jo sirf ```pods``` aur ```deployments``` read karne ki permission deta hai.
```
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: dev-team
  name: pod-reader
rules:
- apiGroups: [""] # "" = core API group
  resources: ["pods", "deployments"]
  verbs: ["get", "list", "watch"]
```

Explanation of Role:


<br>

**ClusterRole**:
- ClusterRole ek permission set hai jo cluster wide permission dene ke liye responsible hota hai.
