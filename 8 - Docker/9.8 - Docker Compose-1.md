# Docker Compose

Docker Compose is the tool which is used to manage multiple containers.

Docker compose is a tool that is used to define and manage multiple containers.

```Docker compose एक tool है जो multiple docker containers को एक yaml file के through define (yaml file मैं containers की configuration लिखना) करता है और उनको manage करता है, manage करने का मतलब है की सभी containers को एक ही साथ run करना, stop करना, delete करना, ये सब हम docker compose के thorugh कर सकते हैं |```

**Problem with Running Multiple Containers**

In real-world applications:
- A single app rarely runs in isolation.
- A web app might need:
  - A web server (like Nginx).
  - A frontend service (like react).
  - A backend service (like nodejs).
  - A database (like mysql).

You can run them as separate containers using Docker CLI, but managing them becomes difficult:
- Each container must be started individually.
- You need to manage networking between them.
- You have to manually handle container dependencies.
- Configuration consistency can be challenging.

**What is Docker Compose? (Core Idea)**

Docker Compose is a tool that solves these problems.

It allows you to:
- Define and run multiple containers as services.
- Use a single YAML configuration file (```docker-compose.yml```) to describe all services.
- Start everything with one command.

<br>

### Why we need Docker Compose

```Docker Compose से पहले Docker का use होता था तो docker के thorugh हम application को container के अंदर run करते थे| Application को container के अंदर run करने के लिए पहले एक Dockerfile बनाते हैं फिर उसको build करते हैं तो docker image बनती है, फिर docker image को run करने पर container run हो जाता है जिसके अंदर application run होता है|```

```यहाँ तो सब ठीक है की हम docker से एक single container आराम से create कर देते हैं, लेकिन practically single container नहीं होता है, practically एक complete application होती हैं जिसमे multiple container एक साथ run करने पर एक application सही से चलती है| जैसे Frontend के लिए एक container चलता है, Backend के लिए एक अलग container चलता है और database के लिए एक अलग container चलता है ये सब container एक दूसरे से connected होते हैं और एक दूसरे से data access करते हैं तो इस सेटअप से एक application रन होती है| तो होता ये है की अगर एक application को run करने के लिए multiple container run हो रहे हैं, तो अगर application start करनी है या stop करनी है तो containers को individually command लिख कर run करना पड़ेगा और सबको सही तरीके से link करना, network setup करना, environment variables देना ये सब बार बार करना करना पड़ेगा| जो की एक tedious task है और best practice नहीं है|```

```जैसे containers को manually run करना और भी मुश्किल जब हो जाता है जब development repeat होती है| इसका मतलब application को बार बार run करो, इसका मतलब 3 या 4 containers बार बार run करो, stop करो ये एक मुश्किल काम हो जाता है जिससे अगर container run करने के time पर docker command मैं कुछ mistake करदी तो वहां error आ सकता है और application up नहीं होगा|```

```तो docker compose इस problem का solution बन कर आया इसमें हम एक single yaml file (docker-compose.yaml) में define कर देते हैं की कौन कौन से containers चाहिए, उनका config क्या होगा, कौन किस से connect होगा, ports क्या होंगे, volumes कहा mount होंगे, etc. फिर सिर्फ एक command docker-compose up से पूरा setup एक साथ चल जाता है मतलब सभी containers एक साथ run हो जाते हैं - बिना बार-बार docker commands लिखे.```

```ये न सिर्फ development fast बनता है बल्कि version control के through सबको एक जैसा setup देता है, जो portable, repeatable और scalable होता है. इस तरह docker compose ने multi-container docker environments बनाना easy, consistent और team-friendly बना दिया|```

<br>

**In simple words**

```Docker compose का use simple एक साथ बहुत सारे containers को start करना, stop करना, delete करना इसलिए होता है मतलब docker compose के thorugh हम एक ही बार मैं बहुत सारे containers को run कर सकते है, stop कर सकते हैं और delete कर सकते है| ये काम हम manually भी कर सकते हैं but docker compose से ये एक ही बार मैं होता है इसलिए docker compose का use करते है|```

<br>

### Advantages of Docker Compose

**Multi-container management asaan ho gaya**
- Ek hi ```docker-compose.yml``` file se tum multiple containers (web, DB, Redis, etc.) ko ek saath define aur manage kar sakte ho — koi bhi service manually chalane ki zarurat nahi.

**Setup repeatable aur consistent ban gaya**
- Har baar same environment chahiye hota hai — dev, staging, prod sab me. Compose se same config har machine par chal jata hai, bina "works on my machine" wali dikkat ke.

**Single command se pura application chalu**
- Bas ek ```docker-compose up``` command aur poora app stack ready ho jata hai — web server, DB, cache, sab kuch.

**Environment variables aur config management easy ho gaya**
- Compose file me tum ```.env``` file use karke easily environment specific settings manage kar sakte ho.

**Built-in networking**
- Har service apne name se doosri service ko access kar sakti hai — DNS ya IPs manage karne ki zarurat nahi. Jaise web container ```db``` ko ```db:5432``` se access kar sakta hai.

**Volume aur data persistence easy**
- Volumes ko define karke tum containers ka data persist kar sakte ho — bina manually mount kiye.

**Scalability testing**
- Kisi service ko scale karna super easy: ```docker-compose up --scale web=3``` — ab 3 instances chalenge without manual setup.

**Easy teardown aur cleanup**
- ```docker-compose down``` se poora environment clean ho jata hai — sab containers, networks, volumes hata diye jaate hain (agar chaho to).

<br>
<br>

### How does Docker Compose works?

If you have your application code and dockerfile ready then follow below steps:
- Create a file with name ```docker-compose.yaml```.
- Run the docker compose file using ```docker compose up```. It will run all containers and your application will be up and running.
- To stop your application run the command ```docker compose down```. It will stop all containers.

Below are the detailed steps:

**Docker Compose Kaise Kaam Karta Hai – Step by Step**

**Step-1: Create  Configuration File – docker-compose.yml**

Sabse pehle, hum ek YAML file banate hain jiska naam hota hai ```docker-compose.yml```. Is file mein hum likhte hain:
- Kitni services chahiye (jaise ```web```, ```db```, ```redis```, etc.).
- Har service ka Docker image kya hoga.
- Ports ka mapping kya hoga.
- Volumes mount karne hain ya nahi.
- Environment variables kya hone chahiye.
- Network settings, dependencies, restart policies, etc.

Example:
```
version: '3'
services:
  web:
    image: nginx
    ports:
      - "8080:80"
  db:
    image: postgres
    environment:
      POSTGRES_PASSWORD: <any_password>
```

**Step-2: Compose CLI Commands**

We need to run the compose cli commands to done everything after create the compose file.

Docker Compose ko command line se control kiya jata hai. Kuch basic commands:
- ```docker-compose up``` → services ko build aur run karta hai.
- ```docker-compose down``` → sab kuch stop aur clean karta hai.
- ```docker-compose logs``` → container logs dikhata hai.
- ```docker-compose ps``` → current running containers dikhata hai.

When we write ```docker-compose up``` command, then Compose:
- Docker Compose YAML file read karta hai.
- Har service ke liye Docker image pull ya build karta hai.
- Fir services ke Containers create karta hai.
- Custom network create karta hai (default bridge network).
- Sab services ko start karta hai in the correct order (agar ```depends_on``` diya ho).

**Networking and Communication**

Docker Compose har stack ke liye ek default network banata hai (bridge type). Isme sab containers ko attach kar diya jata hai, jisse:
- Ek container doosre ko service name se DNS ke through access kar sakta hai.
  - Jaise: ```web``` container ```db``` ko ```db:5432``` se access kar sakta hai. Lekin normally docker main manullay network create karke services attach karni hoti thi.
- Manual IP management ki zarurat nahi hoti.

**Volumes and Data Persistence**

If we specify volumes in docker compose yaml file, then:
- Docker named volumes create karta hai (ya host volumes mount karta hai).
- Isse data containers ke restart ke baad bhi persist karta hai.

<br>
<br>

